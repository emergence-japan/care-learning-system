# Track Specification: 組織・ユーザー数の制限機能

## 1. 概要 (Overview)
システム管理者が各法人に対して「作成可能な施設数」および「登録可能なスタッフ数」の上限を設定できる機能を導入します。これにより、契約プランに応じた利用制限の運用を可能にします。

## 2. ユーザー体験 (User Experience)
- **システム管理者 (SUPER_ADMIN):**
  - 法人の新規登録・編集時に、施設数上限とスタッフ数上限を必須項目として設定する。
  - 法人一覧画面で、上限に対する現在の利用状況（％）を確認でき、上限を超過している場合はアラートが表示される。
- **法人本部 (HQ) / 施設管理者 (ADMIN):**
  - ダッシュボード上で「現在の利用数 / 上限数」を確認できる。
  - 上限に達している場合、「施設追加」や「スタッフ登録」のボタンが非活性（グレーアウト）になり、制限がかかっていることが明示される。

## 3. 機能要件 (Functional Requirements)
- **データモデルの拡張:**
  - `Corporation` モデルに `maxFacilities`（最大施設数）と `maxStaff`（最大スタッフ数）フィールドを追加する（必須、整数）。
- **システム管理者向け機能:**
  - 法人作成・編集フォームへの項目追加。
  - 法人一覧画面への「利用状況サマリー」および「超過アラート」の表示。
- **制限ロジックとUI制御:**
  - 施設追加ボタン・スタッフ登録ボタンの活性/非活性制御。
  - サーバーサイド（Server Actions）での登録実行時のバリデーション強化（UIを回避した不正登録の防止）。
- **進捗表示:**
  - 各ダッシュボードへの「残り枠」表示コンポーネントの追加。

## 4. 非機能要件 (Non-Functional Requirements)
- **整合性:** 制限値が変更された際（例：上限を下げた場合）、既存のデータは削除しないが、新規登録は即座に制限されること。

## 5. 受入基準 (Acceptance Criteria)
- [ ] SUPER_ADMIN が法人の制限値を変更でき、DBに正しく保存されること。
- [ ] 制限数に達した際、HQ/ADMIN 画面で登録ボタンが押せなくなること。
- [ ] 万が一UI制限を抜けてリクエストが送られても、サーバーサイドでエラーを返し登録を阻止すること。
- [ ] 法人一覧画面で利用率が確認できること。
